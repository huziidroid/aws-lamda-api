<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Data Table</title>
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 18px;
      text-align: left;
    }
    th, td {
      padding: 12px;
      border: 1px solid #ddd;
    }
    th {
      background-color: #f4f4f4;
    }
    form {
      margin-bottom: 20px;
    }
    input {
      padding: 8px;
      font-size: 16px;
    }
    button {
      padding: 8px 12px;
      font-size: 16px;
      cursor: pointer;
    }
    #loader {
      display: none;
      margin: 20px 0;
      font-size: 18px;
      color: #555;
    }
    #error-message {
      color: red;
      font-size: 16px;
      display: none;
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <h1>Instances Data</h1>
  <form id="region-form">
    <label for="region">Enter Region:</label>
    <input type="text" id="region" name="region" placeholder="e.g., us-east-1" required>
    <button type="submit">Fetch Data</button>
  </form>
  <p id="loader">Loading data, please wait...</p>
  <p id="error-message">Error fetching data. Please try again.</p>
  <table>
    <thead>
      <tr>
        <th>Region</th>
        <th>Instance ID</th>
        <th>State</th>
      </tr>
    </thead>
    <tbody id="data-table">
      <!-- Rows will be added dynamically -->
    </tbody>
  </table>

  <script>
    document.getElementById('region-form').addEventListener('submit', async function(event) {
      event.preventDefault();

      const regionInput = document.getElementById('region').value;
      const apiUrl = `https://wmrlk8a699.execute-api.us-east-1.amazonaws.com/dev/?Region=${regionInput}`;

      const loader = document.getElementById('loader');
      const errorMessage = document.getElementById('error-message');
      const tableBody = document.getElementById('data-table');

      loader.style.display = 'block';
      errorMessage.style.display = 'none';
      tableBody.innerHTML = ''; // Clear previous data

      try {
        const response = await fetch(apiUrl,{headers:{"Content-Type":"application/json"}});
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        const data = await response.json();

        data.instances.forEach(instance => {
          const row = document.createElement('tr');

          const regionCell = document.createElement('td');
          regionCell.textContent = instance.Region;

          const instanceIdCell = document.createElement('td');
          instanceIdCell.textContent = instance.InstanceId;

          const stateCell = document.createElement('td');
          stateCell.textContent = instance.State;

          row.appendChild(regionCell);
          row.appendChild(instanceIdCell);
          row.appendChild(stateCell);

          tableBody.appendChild(row);
        });
      } catch (error) {
        console.error('Error fetching data:', error);
        errorMessage.style.display = 'block';
      } finally {
        loader.style.display = 'none';
      }
    });
  </script>
</body>
</html>
